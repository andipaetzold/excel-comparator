(this["webpackJsonpexcel-comparator"]=this["webpackJsonpexcel-comparator"]||[]).push([[0],{148:function(e,t){},279:function(e,t){},280:function(e,t){},457:function(e,t,n){"use strict";n.r(t);var r=n(6),a=n.n(r),c=n(29),i=n(460),l=n(58),u=n(27),s=n(201),o=n(73),d=n(72),f=n(0),h=n(5);function j(e){var t=e.headersLeft,n=e.headersRight,r=e.onChange,a=Object(f.useState)([{left:null,right:null}]),j=Object(c.a)(a,2),b=j[0],O=j[1],v=Object(f.useCallback)((function(e,t){O((function(n){return n.map((function(n,r){return Object(o.a)(Object(o.a)({},n),{},{left:r===e?t:n.left})}))}))}),[O]),x=Object(f.useCallback)((function(e,t){O((function(n){return n.map((function(n,r){return Object(o.a)(Object(o.a)({},n),{},{right:r===e?t:n.right})}))}))}),[O]);return Object(f.useEffect)((function(){var e=b[b.length-1];null!==e.left&&null!==e.right&&O((function(e){return[].concat(Object(s.a)(e),[{left:null,right:null}])}))}),[b,O]),Object(f.useEffect)((function(){return r(b.slice(0,-1))}),[r,b]),Object(h.jsx)(i.a,{children:b.map((function(e,r){return Object(h.jsxs)(l.a,{gutter:10,children:[Object(h.jsx)(u.a,{span:12,children:Object(h.jsxs)(d.a,{style:{width:"100%"},value:e.left,onChange:function(e){return v(r,e)},children:[Object(h.jsx)(d.a.Option,{value:null,children:"---"},"null"),t.map((function(e,t){return Object(h.jsx)(d.a.Option,{value:t,children:e},e)}))]})}),Object(h.jsx)(u.a,{span:12,children:Object(h.jsxs)(d.a,{style:{width:"100%"},value:e.right,onChange:function(e){return x(r,e)},children:[Object(h.jsx)(d.a.Option,{value:null,children:"---"},"null"),n.map((function(e,t){return Object(h.jsx)(d.a.Option,{value:t,children:e},e)}))]})})]},r)}))})}var b=n(101),O=n(34),v=n(461),x=n(458);function p(e){return String.fromCharCode("A".charCodeAt(0)+e)}var g=n(57),m=n.n(g);function k(e){var t=e.sheet,n=Object(f.useCallback)((function(){!function(e){for(var t={},n=0;n<e.headers.length;++n){var r=p(n);t["".concat(r,"1")]={v:e.headers[n],t:"s"}}for(var a=0;a<e.data.length;++a)for(var i=0,l=Object.entries(e.data[a]);i<l.length;i++){var u=Object(c.a)(l[i],2),s=u[0],o=u[1];t["".concat(p(+s)).concat(a+1)]=o.cell}t["!ref"]="A1:".concat(p(e.headers.length-1)).concat(e.data.length+1);var d=m.a.utils.book_new();m.a.utils.book_append_sheet(d,t,"Export"),m.a.writeFile(d,"download.xlsx")}(t)}),[t]);return Object(h.jsx)(O.a,{onClick:n,children:"Download"})}function y(e){var t=e.sheet,n=t.headers.map((function(e,t){return{dataIndex:t.toString(),render:function(e){return e.value},key:t,title:e}}));return Object(h.jsx)(x.a,{columns:n,scroll:{x:!0},size:"small",dataSource:t.data,rowKey:function(e,t){return t.toString()},footer:function(){return Object(h.jsx)(k,{sheet:t})}})}function C(e){var t=e.sheetLeft,n=e.sheetRight,r=e.options,a=Object(f.useState)(),i=Object(c.a)(a,2),l=i[0],u=i[1],s=Object(f.useCallback)((function(e,t){var n,a=Object(b.a)(r);try{for(a.s();!(n=a.n()).done;){var c=n.value;if(null!==c.left&&null!==c.right&&e[c.left].value!==t[c.right].value)return!1}}catch(i){a.e(i)}finally{a.f()}return!0}),[r]),o=Object(f.useCallback)((function(e,t){var n,a=Object(b.a)(r);try{for(a.s();!(n=a.n()).done;){var c=n.value;if(null!==c.left&&e[c.left].value!==t[c.left].value)return!1}}catch(i){a.e(i)}finally{a.f()}return!0}),[r]),d=Object(f.useCallback)((function(e,t){var n,a=Object(b.a)(r);try{for(a.s();!(n=a.n()).done;){var c=n.value;if(null!==c.right&&e[c.right].value!==t[c.right].value)return!1}}catch(i){a.e(i)}finally{a.f()}return!0}),[r]),j=Object(f.useMemo)((function(){return t.data.filter((function(e){return!n.data.find((function(t){return s(e,t)}))}))}),[t,n,s]),x=Object(f.useMemo)((function(){return n.data.filter((function(e){return!t.data.find((function(t){return s(t,e)}))}))}),[t,n,s]),p=Object(f.useMemo)((function(){return t.data.filter((function(e){return n.data.find((function(t){return s(e,t)}))}))}),[t,n,s]),g=Object(f.useMemo)((function(){return n.data.filter((function(e){return t.data.find((function(t){return s(t,e)}))}))}),[t,n,s]),m=Object(f.useMemo)((function(){return t.data.filter((function(e,n){return t.data.filter((function(e,t){return n!==t})).find((function(t){return o(e,t)}))}))}),[t,o]),k=Object(f.useMemo)((function(){return n.data.filter((function(e,t){return n.data.filter((function(e,n){return t!==n})).find((function(t){return d(e,t)}))}))}),[n,d]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("ul",{children:[Object(h.jsxs)("li",{children:["Zeilen links, die keine \xfcbereinstimmende Zeile rechts haben:"," ",Object(h.jsx)(O.a,{type:"link",onClick:function(){return u({headers:t.headers,data:j})},children:j.length})]}),Object(h.jsxs)("li",{children:["Zeilen rechts, die keine \xfcbereinstimmende Zeile links haben:"," ",Object(h.jsx)(O.a,{type:"link",onClick:function(){return u({headers:n.headers,data:x})},children:x.length})]}),Object(h.jsxs)("li",{children:["Zeilen links, die eine \xfcbereinstimmende Zeile rechts haben:"," ",Object(h.jsx)(O.a,{type:"link",onClick:function(){return u({headers:t.headers,data:p})},children:p.length})]}),Object(h.jsxs)("li",{children:["Zeilen rechts, die eine \xfcbereinstimmende Zeile links haben:"," ",Object(h.jsx)(O.a,{type:"link",onClick:function(){return u({headers:n.headers,data:g})},children:g.length})]}),Object(h.jsxs)("li",{children:["Duplikate Links:"," ",Object(h.jsx)(O.a,{type:"link",onClick:function(){return u({headers:t.headers,data:m})},children:m.length})]}),Object(h.jsxs)("li",{children:["Duplikate Rechts:"," ",Object(h.jsx)(O.a,{type:"link",onClick:function(){return u({headers:n.headers,data:k})},children:k.length})]})]}),Object(h.jsx)(v.a,{visible:void 0!==l,onOk:function(){return u(void 0)},cancelButtonProps:{style:{display:"none"}},width:"75%",children:l&&Object(h.jsx)(y,{sheet:l})})]})}var S=n(459),w=n(10);function M(e){var t=e.onUpload,n=Object(f.useCallback)((function(e){var n=e.file,r=new FileReader;r.onloadend=function(){if(r.readyState===FileReader.DONE){var e=new Uint8Array(r.result),n=m.a.read(e,{type:"array"}),a=n.Sheets[n.SheetNames[0]];t(a)}},r.readAsArrayBuffer(n)}),[t]);return Object(h.jsx)("div",{style:{textAlign:"center",marginBottom:"10px"},children:Object(h.jsx)(S.a,{accept:"application/msexcel,vnd.openxmlformats-officedocument.spreadsheetml.sheet",showUploadList:!1,customRequest:n,children:Object(h.jsxs)(O.a,{children:[Object(h.jsx)(w.a,{type:"upload"})," Upload"]})})})}function R(e){var t=e.sheet,n=e.onSheet;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(M,{onUpload:n}),t&&Object(h.jsx)(y,{sheet:t})]})}function Z(e){return e?e.w?e.w.toString().trim():e.v?e.v.toString().trim():"":""}function A(e){var t=function(e){for(var t=[],n=0;;){var r=p(n),a="".concat(r,"1");if(void 0===e[a])break;t.push(e[a].v),++n}return t}(e);return{headers:t,data:function(e,t){for(var n=[],r=2;;){for(var a={},c=0;c<t;++c){var i=p(c),l=e["".concat(i).concat(r)];a[c]={cell:l,value:Z(l)}}if(0===Object.values(a).filter((function(e){return""!==e.value})).length)break;n.push(a),++r}return n}(e,t.length)}}function B(){var e=Object(f.useState)(),t=Object(c.a)(e,2),n=t[0],r=t[1],a=Object(f.useState)(),s=Object(c.a)(a,2),o=s[0],d=s[1],b=Object(f.useState)([]),O=Object(c.a)(b,2),v=O[0],x=O[1],p=Object(f.useMemo)((function(){if(n)return A(n)}),[n]),g=Object(f.useMemo)((function(){if(o)return A(o)}),[o]);return Object(h.jsxs)("div",{style:{margin:"5px"},children:[p&&g&&Object(h.jsx)("div",{style:{marginBottom:"10px"},children:Object(h.jsx)(j,{headersLeft:p.headers,headersRight:g.headers,onChange:x})}),p&&g&&Object(h.jsx)(i.a,{style:{marginBottom:"10px"},children:Object(h.jsx)(C,{options:v,sheetLeft:p,sheetRight:g})}),Object(h.jsx)(i.a,{children:Object(h.jsxs)(l.a,{gutter:10,children:[Object(h.jsx)(u.a,{span:12,children:Object(h.jsx)(R,{sheet:p,onSheet:r})}),Object(h.jsx)(u.a,{span:12,children:Object(h.jsx)(R,{sheet:g,onSheet:d})})]})})]})}n(456);a.a.render(Object(h.jsx)(B,{}),document.getElementById("root"))}},[[457,1,2]]]);
//# sourceMappingURL=main.b59054db.chunk.js.map